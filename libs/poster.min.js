(function(){(function(){window.JPEGEncoder=function(c){function a(a,b){for(var e=0,d=0,f=[],g=1;16>=g;g++){for(var c=1;c<=a[g];c++)f[b[d]]=[],f[b[d]][0]=e,f[b[d]][1]=g,d++,e++;e*=2}return f}function b(a){var b=a[0];for(a=a[1]-1;0<=a;)b&1<<a&&(v|=1<<t),a--,t--,0>t&&(255==v?(d(255),d(0)):d(v),t=7,v=0)}function d(a){F.push(N[a])}function e(a){d(a>>8&255);d(a&255)}function f(a,e,d,f,g){var c=g[0],l=g[240],k,h,m,v,r,n,t,p,x,s=0;for(k=0;8>k;++k){h=a[s];m=a[s+1];v=a[s+2];r=a[s+3];n=a[s+4];t=a[s+5];p=a[s+
6];x=a[s+7];var C=h+x;h-=x;x=m+p;m-=p;p=v+t;v-=t;t=r+n;r-=n;n=C+t;C-=t;t=x+p;x-=p;a[s]=n+t;a[s+4]=n-t;n=0.707106781*(x+C);a[s+2]=C+n;a[s+6]=C-n;n=r+v;t=v+m;x=m+h;v=0.382683433*(n-x);r=0.5411961*n+v;n=1.306562965*x+v;t*=0.707106781;v=h+t;h-=t;a[s+5]=h+r;a[s+3]=h-r;a[s+1]=v+n;a[s+7]=v-n;s+=8}for(k=s=0;8>k;++k)h=a[s],m=a[s+8],v=a[s+16],r=a[s+24],n=a[s+32],t=a[s+40],p=a[s+48],x=a[s+56],C=h+x,h-=x,x=m+p,m-=p,p=v+t,v-=t,t=r+n,r-=n,n=C+t,C-=t,t=x+p,x-=p,a[s]=n+t,a[s+32]=n-t,n=0.707106781*(x+C),a[s+16]=C+
n,a[s+48]=C-n,n=r+v,t=v+m,x=m+h,v=0.382683433*(n-x),r=0.5411961*n+v,n=1.306562965*x+v,t*=0.707106781,v=h+t,h-=t,a[s+40]=h+r,a[s+24]=h-r,a[s+8]=v+n,a[s+56]=v-n,s++;for(k=0;64>k;++k)s=a[k]*e[k],K[k]=0<s?s+0.5|0:s-0.5|0;a=K;for(e=0;64>e;++e)A[E[e]]=a[e];a=A[0]-d;d=A[0];0==a?b(f[0]):(k=32767+a,b(f[y[k]]),b(u[k]));for(f=63;0<f&&0==A[f];f--);if(0==f)return b(c),d;for(a=1;a<=f;){for(e=a;0==A[a]&&a<=f;++a);e=a-e;if(16<=e){k=e>>4;for(s=1;s<=k;++s)b(l);e&=15}k=32767+A[a];b(g[(e<<4)+y[k]]);b(u[k]);a++}63!=f&&
b(c);return d}function k(a){0>=a&&(a=1);100<a&&(a=100);if(O!=a){for(var b=0,b=50>a?Math.floor(5E3/a):Math.floor(200-2*a),e=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],d=0;64>d;d++){var f=g((e[d]*b+50)/100);1>f?f=1:255<f&&(f=255);l[E[d]]=f}e=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,
99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99];for(d=0;64>d;d++)f=g((e[d]*b+50)/100),1>f?f=1:255<f&&(f=255),h[E[d]]=f;b=[1,1.387039845,1.306562965,1.175875602,1,0.785694958,0.5411961,0.275899379];for(d=e=0;8>d;d++)for(f=0;8>f;f++)m[e]=1/(8*l[E[e]]*b[d]*b[f]),r[e]=1/(8*h[E[e]]*b[d]*b[f]),e++;O=a;console.log("Quality set to: "+a+"%")}}var g=Math.floor,l=Array(64),h=Array(64),m=Array(64),r=Array(64),n,z,w,p,u=Array(65535),y=Array(65535),K=Array(64),A=Array(64),
F=[],v=0,t=7,x=Array(64),P=Array(64),C=Array(64),N=Array(256),B=Array(2048),O,E=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],R=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],S=[0,1,2,3,4,5,6,7,8,9,10,11],T=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],U=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,
25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],V=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],W=[0,1,2,3,4,5,
6,7,8,9,10,11],X=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],Y=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,
198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];this.encode=function(a,g){var c=(new Date).getTime();g&&k(g);F=[];v=0;t=7;e(65496);e(65504);e(16);d(74);d(70);d(73);d(70);d(0);d(1);d(1);d(0);e(1);e(1);d(0);d(0);e(65499);e(132);d(0);for(var q=0;64>q;q++)d(l[q]);d(1);for(q=0;64>q;q++)d(h[q]);var q=a.width,u=a.height;e(65472);e(17);d(8);e(u);e(q);d(3);d(1);d(17);d(0);d(2);d(17);d(1);d(3);d(17);d(1);e(65476);e(418);d(0);for(q=
0;16>q;q++)d(R[q+1]);for(q=0;11>=q;q++)d(S[q]);d(16);for(q=0;16>q;q++)d(T[q+1]);for(q=0;161>=q;q++)d(U[q]);d(1);for(q=0;16>q;q++)d(V[q+1]);for(q=0;11>=q;q++)d(W[q]);d(17);for(q=0;16>q;q++)d(X[q+1]);for(q=0;161>=q;q++)d(Y[q]);e(65498);e(12);d(3);d(1);d(0);d(2);d(17);d(3);d(17);d(0);d(63);d(0);var y=u=q=0;v=0;t=7;this.encode.displayName="_encode_";for(var A=a.data,E=a.height,L=4*a.width,J,M=0,G,H,D,K,I;M<E;){for(J=0;J<L;){K=L*M+J;for(I=0;64>I;I++)H=I>>3,G=4*(I&7),D=K+H*L+G,M+H>=E&&(D-=L*(M+1+H-E)),
J+G>=L&&(D-=J+G-L+4),G=A[D++],H=A[D++],D=A[D++],x[I]=(B[G]+B[H+256>>0]+B[D+512>>0]>>16)-128,P[I]=(B[G+768>>0]+B[H+1024>>0]+B[D+1280>>0]>>16)-128,C[I]=(B[G+1280>>0]+B[H+1536>>0]+B[D+1792>>0]>>16)-128;q=f(x,m,q,n,w);u=f(P,r,u,z,p);y=f(C,r,y,z,p);J+=32}M+=8}0<=t&&(q=[],q[1]=t+1,q[0]=(1<<t+1)-1,b(q));e(65497);q="data:image/jpeg;base64,"+btoa(F.join(""));F=[];c=(new Date).getTime()-c;console.log("Encoding time: "+c+"ms");return q};(function(){var b=(new Date).getTime();c||(c=50);for(var e=String.fromCharCode,
d=0;256>d;d++)N[d]=e(d);n=a(R,S);z=a(V,W);w=a(T,U);p=a(X,Y);for(var e=1,d=2,f=1;15>=f;f++){for(var g=e;g<d;g++)y[32767+g]=f,u[32767+g]=[],u[32767+g][1]=f,u[32767+g][0]=g;for(g=-(d-1);g<=-e;g++)y[32767+g]=f,u[32767+g]=[],u[32767+g][1]=f,u[32767+g][0]=d-1+g;e<<=1;d<<=1}for(e=0;256>e;e++)B[e]=19595*e,B[e+256>>0]=38470*e,B[e+512>>0]=7471*e+32768,B[e+768>>0]=-11059*e,B[e+1024>>0]=-21709*e,B[e+1280>>0]=32768*e+8421375,B[e+1536>>0]=-27439*e,B[e+1792>>0]=-5329*e;k(c);b=(new Date).getTime()-b;console.log("Initialization "+
b+"ms")})()}})();(function(){window.EXIF={};(function(){function c(a,b,e){a.addEventListener?a.addEventListener(b,e,!1):a.attachEvent&&a.attachEvent("on"+b,e)}function a(a,e){BinaryAjax(a.src,function(d){d=b(d.binaryResponse);a.exifdata=d||{};e&&e()})}function b(a){if(255!=a.getByteAt(0)||216!=a.getByteAt(1))return!1;for(var b=2,e=a.getLength();b<e;){if(255!=a.getByteAt(b))return k&&console.log("Not a valid marker at offset "+b+", found: "+a.getByteAt(b)),!1;var d=a.getByteAt(b+1);if(22400==d||225==
d)return k&&console.log("Found 0xFFE1 marker"),f(a,b+4,a.getShortAt(b+2,!0)-2);b+=2+a.getShortAt(b+2,!0)}}function d(a,b,d,f,c){for(var n=a.getShortAt(d,c),z={},w=0;w<n;w++){var p=d+12*w+2,u=f[a.getShortAt(p,c)];!u&&k&&console.log("Unknown tag: "+a.getShortAt(p,c));z[u]=e(a,p,b,d,c)}return z}function e(a,b,e,d,f){var c=a.getShortAt(b+2,f);d=a.getLongAt(b+4,f);e=a.getLongAt(b+8,f)+e;switch(c){case 1:case 7:if(1==d)return a.getByteAt(b+8,f);e=4<d?e:b+8;b=[];for(c=0;c<d;c++)b[c]=a.getByteAt(e+c);return b;
case 2:return a.getStringAt(4<d?e:b+8,d-1);case 3:if(1==d)return a.getShortAt(b+8,f);e=2<d?e:b+8;b=[];for(c=0;c<d;c++)b[c]=a.getShortAt(e+2*c,f);return b;case 4:if(1==d)return a.getLongAt(b+8,f);b=[];for(c=0;c<d;c++)b[c]=a.getLongAt(e+4*c,f);return b;case 5:if(1==d)return a.getLongAt(e,f)/a.getLongAt(e+4,f);b=[];for(c=0;c<d;c++)b[c]=a.getLongAt(e+8*c,f)/a.getLongAt(e+4+8*c,f);return b;case 9:if(1==d)return a.getSLongAt(b+8,f);b=[];for(c=0;c<d;c++)b[c]=a.getSLongAt(e+4*c,f);return b;case 10:if(1==
d)return a.getSLongAt(e,f)/a.getSLongAt(e+4,f);b=[];for(c=0;c<d;c++)b[c]=a.getSLongAt(e+8*c,f)/a.getSLongAt(e+4+8*c,f);return b}}function f(a,b,e){if("Exif"!=a.getStringAt(b,4))return k&&console.log("Not valid EXIF data! "+a.getStringAt(b,4)),!1;var f=b+6;if(18761==a.getShortAt(f))e=!1;else if(19789==a.getShortAt(f))e=!0;else return k&&console.log("Not valid TIFF data! (no 0x4949 or 0x4D4D)"),!1;if(42!=a.getShortAt(f+2,e))return k&&console.log("Not valid TIFF data! (no 0x002A)"),!1;if(8!=a.getLongAt(f+
4,e))return k&&console.log("Not valid TIFF data! (First offset not 8)",a.getShortAt(f+4,e)),!1;b=d(a,f,f+8,EXIF.TiffTags,e);if(b.ExifIFDPointer){var c=d(a,f,f+b.ExifIFDPointer,EXIF.Tags,e),n;for(n in c){switch(n){case "LightSource":case "Flash":case "MeteringMode":case "ExposureProgram":case "SensingMethod":case "SceneCaptureType":case "SceneType":case "CustomRendered":case "WhiteBalance":case "GainControl":case "Contrast":case "Saturation":case "Sharpness":case "SubjectDistanceRange":case "FileSource":c[n]=
EXIF.StringValues[n][c[n]];break;case "ExifVersion":case "FlashpixVersion":c[n]=String.fromCharCode(c[n][0],c[n][1],c[n][2],c[n][3]);break;case "ComponentsConfiguration":c[n]=EXIF.StringValues.Components[c[n][0]]+EXIF.StringValues.Components[c[n][1]]+EXIF.StringValues.Components[c[n][2]]+EXIF.StringValues.Components[c[n][3]]}b[n]=c[n]}}if(b.GPSInfoIFDPointer)for(n in a=d(a,f,f+b.GPSInfoIFDPointer,EXIF.GPSTags,e),a){switch(n){case "GPSVersionID":a[n]=a[n][0]+"."+a[n][1]+"."+a[n][2]+"."+a[n][3]}b[n]=
a[n]}return b}var k=!1;EXIF.Tags={36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",
34856:"OECF",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",
41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRation",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",40965:"InteroperabilityIFDPointer",42016:"ImageUniqueID"};EXIF.TiffTags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",
259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",
272:"Model",305:"Software",315:"Artist",33432:"Copyright"};EXIF.GPSTags={"0":"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",
24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential"};EXIF.StringValues={ExposureProgram:{"0":"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{"0":"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{"0":"Unknown",
1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{"0":"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",
7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",
71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},
SensingMethod:{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{"0":"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{"0":"Normal process",1:"Custom process"},WhiteBalance:{"0":"Auto white balance",1:"Manual white balance"},GainControl:{"0":"None",1:"Low gain up",2:"High gain up",
3:"Low gain down",4:"High gain down"},Contrast:{"0":"Normal",1:"Soft",2:"Hard"},Saturation:{"0":"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{"0":"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{"0":"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},Components:{"0":"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}};EXIF.getData=function(b,e){if(!b.complete)return!1;b.exifdata?e&&e():a(b,e);return!0};EXIF.getTag=function(a,b){if(a.exifdata)return a.exifdata[b]};EXIF.getAllTags=
function(a){if(!a.exifdata)return{};a=a.exifdata;var b={},e;for(e in a)a.hasOwnProperty(e)&&(b[e]=a[e]);return b};EXIF.pretty=function(a){if(!a.exifdata)return"";a=a.exifdata;var b="",e;for(e in a)a.hasOwnProperty(e)&&(b="object"==typeof a[e]?b+(e+" : ["+a[e].length+" values]\r\n"):b+(e+" : "+a[e]+"\r\n"));return b};EXIF.readFromBinaryFile=function(a){return b(a)};c(window,"load",function(){for(var a=document.getElementsByTagName("img"),b=0;b<a.length;b++)"true"==a[b].getAttribute("exif")&&(a[b].complete?
EXIF.getData(a[b]):c(a[b],"load",function(){EXIF.getData(this)}))})})()})();(function(){window.BinaryFile=function(c,a,b){var d=c,e=a||0,f=0;this.getRawData=function(){return d};"string"==typeof c?(f=b||d.length,this.getByteAt=function(a){return d.charCodeAt(a+e)&255},this.getBytesAt=function(a,b){for(var f=[],c=0;c<b;c++)f[c]=d.charCodeAt(a+c+e)&255;return f}):"unknown"==typeof c&&(f=b||IEBinary_getLength(d),this.getByteAt=function(a){return IEBinary_getByteAt(d,a+e)},this.getBytesAt=function(a,
b){return(new VBArray(IEBinary_getBytesAt(d,a+e,b))).toArray()});this.getLength=function(){return f};this.getSByteAt=function(a){a=this.getByteAt(a);return 127<a?a-256:a};this.getShortAt=function(a,b){var e=b?(this.getByteAt(a)<<8)+this.getByteAt(a+1):(this.getByteAt(a+1)<<8)+this.getByteAt(a);0>e&&(e+=65536);return e};this.getSShortAt=function(a,b){var e=this.getShortAt(a,b);return 32767<e?e-65536:e};this.getLongAt=function(a,b){var e=this.getByteAt(a),d=this.getByteAt(a+1),f=this.getByteAt(a+2),
c=this.getByteAt(a+3),e=b?(((e<<8)+d<<8)+f<<8)+c:(((c<<8)+f<<8)+d<<8)+e;0>e&&(e+=4294967296);return e};this.getSLongAt=function(a,b){var e=this.getLongAt(a,b);return 2147483647<e?e-4294967296:e};this.getStringAt=function(a,b){for(var e=[],d=this.getBytesAt(a,b),f=0;f<b;f++)e[f]=String.fromCharCode(d[f]);return e.join("")};this.getCharAt=function(a){return String.fromCharCode(this.getByteAt(a))};this.toBase64=function(){return window.btoa(d)};this.fromBase64=function(a){d=window.atob(a)}};(function(){function c(){var a=
null;window.ActiveXObject?a=new ActiveXObject("Microsoft.XMLHTTP"):window.XMLHttpRequest&&(a=new XMLHttpRequest);return a}function a(a,b,f){var k=c();k?(b&&("undefined"!=typeof k.onload?k.onload=function(){"200"==k.status?b(this):f&&f();k=null}:k.onreadystatechange=function(){4==k.readyState&&("200"==k.status?b(this):f&&f(),k=null)}),k.open("HEAD",a,!0),k.send(null)):f&&f()}function b(a,b,f,k,g,l){var h=c();if(h){var m=0;k&&!g&&(m=k[0]);var r=0;k&&(r=k[1]-k[0]+1);b&&("undefined"!=typeof h.onload?
h.onload=function(){"200"==h.status||"206"==h.status||"0"==h.status?(h.binaryResponse=new BinaryFile(h.responseText,m,r),h.fileSize=l||h.getResponseHeader("Content-Length"),b(h)):f&&f();h=null}:h.onreadystatechange=function(){if(4==h.readyState){if("200"==h.status||"206"==h.status||"0"==h.status){var a={status:h.status,binaryResponse:new BinaryFile("unknown"==typeof h.responseBody?h.responseBody:h.responseText,m,r),fileSize:l||h.getResponseHeader("Content-Length")};b(a)}else f&&f();h=null}});h.open("GET",
a,!0);h.overrideMimeType&&h.overrideMimeType("text/plain; charset\x3dx-user-defined");k&&g&&h.setRequestHeader("Range","bytes\x3d"+k[0]+"-"+k[1]);h.setRequestHeader("If-Modified-Since","Sat, 1 Jan 1970 00:00:00 GMT");h.send(null)}else f&&f()}return function(d,e,f,c){c?a(d,function(a){var l=parseInt(a.getResponseHeader("Content-Length"),10);a=a.getResponseHeader("Accept-Ranges");var h;h=c[0];0>c[0]&&(h+=l);b(d,e,f,[h,h+c[1]-1],"bytes"==a,l)}):b(d,e,f)}})();document.write("\x3cscript type\x3d'text/vbscript'\x3e\r\nFunction IEBinary_getByteAt(strBinary, iOffset)\r\n\tIEBinary_getByteAt \x3d AscB(MidB(strBinary, iOffset + 1, 1))\r\nEnd Function\r\nFunction IEBinary_getBytesAt(strBinary, iOffset, iLength)\r\n  Dim aBytes()\r\n  ReDim aBytes(iLength - 1)\r\n  For i \x3d 0 To iLength - 1\r\n   aBytes(i) \x3d IEBinary_getByteAt(strBinary, iOffset + i)\r\n  Next\r\n  IEBinary_getBytesAt \x3d aBytes\r\nEnd Function\r\nFunction IEBinary_getLength(strBinary)\r\n\tIEBinary_getLength \x3d LenB(strBinary)\r\nEnd Function\r\n\x3c/script\x3e\r\n")})();
(function(){(function(c){function a(a,b,d){for(var c=a.length,l=b.length,h,m,r,n,z,w,p=0,u=h=0;u<c;u++){h=a[u];m=a[u<c-1?u+1:0];p=h.y-m.y;h=m.x-h.x;m=Math.sqrt(p*p+h*h);p/=m;h/=m;m=r=a[0].x*p+a[0].y*h;for(var y=1;y<c;y++)w=a[y].x*p+a[y].y*h,w>r?r=w:w<m&&(m=w);n=z=b[0].x*p+b[0].y*h;for(y=1;y<l;y++)w=b[y].x*p+b[y].y*h,w>z?z=w:w<n&&(n=w);m<n?(m=n-r,p=-p,h=-h):m-=z;if(0<=m)return!1;m>d.overlap&&(d.overlap=m,d.normal.x=p,d.normal.y=h)}return d}var b=c.Quark=c.Quark||{global:c},d=function(){};b.inherit=
function(a,b){d.prototype=b.prototype;a.superClass=b.prototype;a.prototype=new d;a.prototype.constructor=a};b.merge=function(a,b,d){for(var c in b)if(!d||a.hasOwnProperty(c)||void 0!==a[c])a[c]=b[c];return a};b.delegate=function(a,b){var d=b||c;if(2<arguments.length){var g=Array.prototype.slice.call(arguments,2);return function(){var b=Array.prototype.concat.apply(g,arguments);return a.apply(d,b)}}return function(){return a.apply(d,arguments)}};b.getDOM=function(a){return document.getElementById(a)};
b.createDOM=function(a,b){var d=document.createElement(a),c;for(c in b){var l=b[c];if("style"==c)for(var h in l)d.style[h]=l[h];else d[c]=l}return d};b.use=function(a){a=a.split(".");for(var b=c,d=0;d<a.length;d++)var g=a[d],b=b[g]||(b[g]={});return b};(function(a){var b=a.ua=navigator.userAgent;a.isWebKit=/webkit/i.test(b);a.isMozilla=/mozilla/i.test(b);a.isIE=/msie/i.test(b);a.isFirefox=/firefox/i.test(b);a.isChrome=/chrome/i.test(b);a.isSafari=/safari/i.test(b)&&!this.isChrome;a.isMobile=/mobile/i.test(b);
a.isOpera=/opera/i.test(b);a.isIOS=/ios/i.test(b);a.isIpad=/ipad/i.test(b);a.isIpod=/ipod/i.test(b);a.isIphone=/iphone/i.test(b)&&!this.isIpod;a.isAndroid=/android/i.test(b);a.supportStorage="localStorage"in c;a.supportOrientation="orientation"in c;a.supportDeviceMotion="ondevicemotion"in c;a.supportTouch="ontouchstart"in c;a.supportCanvas=null!=document.createElement("canvas").getContext;a.cssPrefix=a.isWebKit?"webkit":a.isFirefox?"Moz":a.isOpera?"O":a.isIE?"ms":""})(b);b.getElementOffset=function(a){for(var b=
a.offsetLeft,d=a.offsetTop;(a=a.offsetParent)&&a!=document.body&&a!=document;)b+=a.offsetLeft,d+=a.offsetTop;return{left:b,top:d}};b.createDOMDrawable=function(a,d){var c=a.tagName||"div",g=d.image,l=a.width||g&&g.width,h=a.height||g&&g.height,m=b.createDOM(c);a.id&&(m.id=a.id);m.style.position="absolute";m.style.left=(a.left||0)+"px";m.style.top=(a.top||0)+"px";m.style.width=l+"px";m.style.height=h+"px";"canvas"==c?(m.width=l,m.height=h,g&&(c=m.getContext("2d"),l=d.rect||[0,0,l,h],c.drawImage(g,
l[0],l[1],l[2],l[3],a.x||0,a.y||0,a.width||l[2],a.height||l[3]))):(m.style.opacity=void 0!=a.alpha?a.alpha:1,m.style.overflow="hidden",g&&g.src&&(m.style.backgroundImage="url("+g.src+")",m.style.backgroundPosition=-(a.rectX||0)+"px "+-(a.rectY||0)+"px"));return m};b.DEG_TO_RAD=Math.PI/180;b.RAD_TO_DEG=180/Math.PI;b.hitTestPoint=function(a,b,d,c){a=a.getBounds();var l=a.length,h=b>=a.x&&b<=a.x+a.width&&d>=a.y&&d<=a.y+a.height;if(h&&c){c=0;for(var h=!1,m,r,n,z,w=0;w<l;w++){var p=a[w],u=a[(w+1)%l];if(p.y==
u.y&&d==p.y&&(p.x>u.x?(m=u.x,r=p.x):(m=p.x,r=u.x),b>=m&&b<=r)){h=!0;continue}p.y>u.y?(n=u.y,z=p.y):(n=p.y,z=u.y);d<n||d>z||(p=(d-p.y)*(u.x-p.x)/(u.y-p.y)+p.x,p>b?c++:p==b&&(h=!0))}return h?0:1==c%2?1:-1}return h?1:-1};b.hitTestObject=function(a,d,c){a=a.getBounds();d=d.getBounds();return(a=a.x<=d.x+d.width&&d.x<=a.x+a.width&&a.y<=d.y+d.height&&d.y<=a.y+a.height)&&c?(a=b.polygonCollision(d,d),!1!==a):a};b.polygonCollision=function(b,d){var c=a(b,d,{overlap:-Infinity,normal:{x:0,y:0}});return c?a(d,
b,c):!1};b.toString=function(){return"Quark"};b.trace=function(){var a=Array.prototype.slice.call(arguments);"undefined"!=typeof console&&"undefined"!=typeof console.log&&console.log(a.join(" "))};void 0==c.Q&&(c.Q=b);void 0==c.trace&&(c.trace=b.trace)})(window);(function(){var c=Quark.Matrix=function(a,b,d,e,c,k){this.a=a;this.b=b;this.c=d;this.d=e;this.tx=c;this.ty=k};c.prototype.concat=function(a){var b=this.a,d=this.c,e=this.tx;this.a=b*a.a+this.b*a.c;this.b=b*a.b+this.b*a.d;this.c=d*a.a+this.d*
a.c;this.d=d*a.b+this.d*a.d;this.tx=e*a.a+this.ty*a.c+a.tx;this.ty=e*a.b+this.ty*a.d+a.ty;return this};c.prototype.rotate=function(a){var b=Math.cos(a);a=Math.sin(a);var d=this.a,e=this.c,c=this.tx;this.a=d*b-this.b*a;this.b=d*a+this.b*b;this.c=e*b-this.d*a;this.d=e*a+this.d*b;this.tx=c*b-this.ty*a;this.ty=c*a+this.ty*b;return this};c.prototype.scale=function(a,b){this.a*=a;this.d*=b;this.tx*=a;this.ty*=b;return this};c.prototype.translate=function(a,b){this.tx+=a;this.ty+=b;return this};c.prototype.identity=
function(){this.a=this.d=1;this.b=this.c=this.tx=this.ty=0;return this};c.prototype.invert=function(){var a=this.a,b=this.b,d=this.c,e=this.d,c=this.tx,k=a*e-b*d;this.a=e/k;this.b=-b/k;this.c=-d/k;this.d=a/k;this.tx=(d*this.ty-e*c)/k;this.ty=-(a*this.ty-b*c)/k;return this};c.prototype.transformPoint=function(a,b,d){var e=a.x*this.a+a.y*this.c+this.tx,c=a.x*this.b+a.y*this.d+this.ty;b&&(e=e+0.5>>0,c=c+0.5>>0);if(d)return{x:e,y:c};a.x=e;a.y=c;return a};c.prototype.clone=function(){return new c(this.a,
this.b,this.c,this.d,this.tx,this.ty)};c.prototype.toString=function(){return"(a\x3d"+this.a+", b\x3d"+this.b+", c\x3d"+this.c+", d\x3d"+this.d+", tx\x3d"+this.tx+", ty\x3d"+this.ty+")"}})();(function(){var c=Quark.Rectangle=function(a,b,d,e){this.x=a;this.y=b;this.width=d;this.height=e};c.prototype.intersects=function(a){return this.x<=a.x+a.width&&a.x<=this.x+this.width&&this.y<=a.y+a.height&&a.y<=this.y+this.height};c.prototype.intersection=function(a){var b=Math.max(this.x,a.x),d=Math.min(this.x+
this.width,a.x+a.width);if(b<=d){var e=Math.max(this.y,a.y);a=Math.min(this.y+this.height,a.y+a.height);if(e<=a)return new c(b,e,d-b,a-e)}return null};c.prototype.union=function(a,b){var d=Math.max(this.x+this.width,a.x+a.width),e=Math.max(this.y+this.height,a.y+a.height),f=Math.min(this.x,a.x),k=Math.min(this.y,a.y),d=d-f,e=e-k;if(b)return new c(f,k,d,e);this.x=f;this.y=k;this.width=d;this.height=e};c.prototype.containsPoint=function(a,b){return this.x<=a&&a<=this.x+this.width&&this.y<=b&&b<=this.y+
this.height};c.prototype.clone=function(){return new c(this.x,this.y,this.width,this.height)};c.prototype.toString=function(){return"(x\x3d"+this.x+", y\x3d"+this.y+", width\x3d"+this.width+", height\x3d"+this.height+")"}})();Quark.KEY={MOUSE_LEFT:1,MOUSE_MID:2,MOUSE_RIGHT:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,RETURN:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,
ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,
F12:123};(function(){var c=Quark.EventManager=function(){this.keyState={};this._evtHandlers={}};c.prototype.registerStage=function(a,b,d,e){this.register(a.context.canvas,b,{host:a,func:a.dispatchEvent},d,e)};c.prototype.unregisterStage=function(a,b){this.unregister(a.context.canvas,b,a.dispatchEvent)};c.prototype.register=function(a,b,d,e,c){if(null==d||"function"==typeof d)d={host:null,func:d};var k={prevent:e,stop:c},g=this;e=function(a){g._onEvent(a,k,d)};for(c=0;c<b.length;c++){for(var l=b[c],
h=this._evtHandlers[l]||(this._evtHandlers[l]=[]),m=0,r=!1;m<h.length;m++){var n=h[m];if(n.target==a&&n.callback.func==d.func){trace("duplicate callback");r=!0;break}}r||(h.push({target:a,callback:d,handler:e}),a.addEventListener(l,e,!1))}};c.prototype.unregister=function(a,b,d){for(var e=0;e<b.length;e++)for(var c=b[e],k=this._evtHandlers[c],g=0;g<k.length;g++){var l=k[g];if(l.target==a&&(l.callback.func==d||null==d)){a.removeEventListener(c,l.handler);k.splice(g,1);break}}};c.prototype._onEvent=
function(a,b,d){var e=a,f=a.type;0==a.type.indexOf("touch")&&(e=a.touches&&0<a.touches.length?a.touches[0]:a.changedTouches&&0<a.changedTouches.length?a.changedTouches[0]:a,e.type=f,e.rawEvent=a);if("keydown"==f||"keyup"==f||"keypress"==f)this.keyState[a.keyCode]=f;null!=d.func&&d.func.call(d.host,e);c.stop(a,!b.prevent,!b.stop)};c.stop=function(a,b,d){b||a.preventDefault();d||(a.stopPropagation(),a.stopImmediatePropagation&&a.stopImmediatePropagation())}})();(function(){var c=Quark.EventDispatcher=
function(){this._eventMap={}};c.prototype.addEventListener=function(a,b){var d=this._eventMap[a];null==d&&(d=this._eventMap[a]=[]);return-1==d.indexOf(b)?(d.push(b),!0):!1};c.prototype.removeEventListener=function(a,b){if(1==arguments.length)return this.removeEventListenerByType(a);var d=this._eventMap[a];if(null==d)return!1;for(var c=0;c<d.length;c++)if(d[c]===b)return d.splice(c,1),0==d.length&&delete this._eventMap[a],!0;return!1};c.prototype.removeEventListenerByType=function(a){return null!=
this._eventMap[a]?(delete this._eventMap[a],!0):!1};c.prototype.removeAllEventListeners=function(){this._eventMap={}};c.prototype.dispatchEvent=function(a){var b=this._eventMap[a.type];if(null==b)return!1;a.target||(a.target=this);for(var b=b.slice(),d=0;d<b.length;d++){var c=b[d];"function"==typeof c&&c.call(this,a)}return!0};c.prototype.hasEventListener=function(a){a=this._eventMap[a];return null!=a&&0<a.length};c.prototype.on=c.prototype.addEventListener;c.prototype.un=c.prototype.removeEventListener;
c.prototype.fire=c.prototype.dispatchEvent})();(function(){var c=Quark.Context=function(a){if(null==a.canvas)throw"Quark.Context Error: canvas is required.";this.canvas=null;Quark.merge(this,a)};c.prototype.startDraw=function(){};c.prototype.draw=function(){};c.prototype.endDraw=function(){};c.prototype.transform=function(){};c.prototype.remove=function(a){}})();(function(){var c=Quark.CanvasContext=function(a){c.superClass.constructor.call(this,a);this.context=this.canvas.getContext("2d")};Quark.inherit(c,
Quark.Context);c.prototype.startDraw=function(){this.context.save()};c.prototype.draw=function(a){if(!(null!=a.parent&&null!=a.parent.mask))if(null!=a.mask){var b=a.width,d=a.height,c=Q._helpContext,f=c.canvas,k=c.context;f.width=0;f.width=b;f.height=d;c.startDraw();a.mask._render(c);k.globalCompositeOperation="source-in";var g=a.mask;a.mask=null;if(a instanceof Quark.DisplayObjectContainer){var l=a._cache||Quark.cacheObject(a);k.drawImage(l,0,0,b,d,0,0,b,d)}else a.render(c);c.endDraw();a.mask=g;
arguments[0]=f;this.context.drawImage.apply(this.context,arguments)}else null!=a._cache?this.context.drawImage(a._cache,0,0):a instanceof Quark.Graphics||a instanceof Quark.Text?a._draw(this.context):(b=a.getDrawable(this),null!=b&&(arguments[0]=b,this.context.drawImage.apply(this.context,arguments)))};c.prototype.endDraw=function(){this.context.restore()};c.prototype.transform=function(a){var b=this.context;a instanceof Q.Stage?(a._scaleX!=a.scaleX&&(a._scaleX=a.scaleX,this.canvas.style.width=a._scaleX*
a.width+"px"),a._scaleY!=a.scaleY&&(a._scaleY=a.scaleY,this.canvas.style.height=a._scaleY*a.height+"px")):((0!=a.x||0!=a.y)&&b.translate(a.x,a.y),0!=a.rotation%360&&b.rotate(a.rotation%360*Quark.DEG_TO_RAD),(1!=a.scaleX||1!=a.scaleY)&&b.scale(a.scaleX,a.scaleY),(0!=a.regX||0!=a.regY)&&b.translate(-a.regX,-a.regY));0<a.alpha&&(b.globalAlpha*=a.alpha)};c.prototype.clear=function(a,b,d,c){this.context.clearRect(a,b,d,c)}})();(function(){function c(a,b){var d="";return d=b?d+("translate3d("+(a.x-a.regX)+
"px, "+(a.y-a.regY)+"px, 0px)rotate3d(0, 0, 1, "+a.rotation+"deg)scale3d("+a.scaleX+", "+a.scaleY+", 1)"):d+("translate("+(a.x-a.regX)+"px, "+(a.y-a.regY)+"px)rotate("+a.rotation+"deg)scale("+a.scaleX+", "+a.scaleY+")")}var a=document.createElement("div"),b=void 0!=a.style[Quark.cssPrefix+"Transform"],d=void 0!=a.style[Quark.cssPrefix+"Perspective"],e=document.documentElement;if(d&&"webkitPerspective"in e.style){a.id="test3d";var f=document.createElement("style");f.textContent="@media (-webkit-transform-3d){#test3d{height:3px}}";
document.head.appendChild(f);e.appendChild(a);d=3===a.offsetHeight;f.parentNode.removeChild(f);a.parentNode.removeChild(a)}Quark.supportTransform=b;Quark.supportTransform3D=d;if(b){var k=Quark.DOMContext=function(a){k.superClass.constructor.call(this,a)};Quark.inherit(k,Quark.Context);k.prototype.draw=function(a){if(!a._addedToDOM){var b=a.parent,d=a.getDrawable(this);if(null!=b){var c=b.getDrawable(this);d.parentNode!=c&&c.appendChild(d);null==c.parentNode&&b instanceof Quark.Stage&&(this.canvas.appendChild(c),
b._addedToDOM=!0);a._addedToDOM=!0}}};k.prototype.transform=function(a){var b=a.getDrawable(this);if(a.transformEnabled||!a._addedToDOM){var d=Quark.cssPrefix,e=d+"TransformOrigin",d=d+"Transform",b=b.style;if(!b.display||a.propChanged("visible","alpha"))b.display=!a.visible||0>=a.alpha?"none":"";if(!b.opacity||a.propChanged("alpha"))b.opacity=a.alpha;if(!b.backgroundPosition||a.propChanged("rectX","rectY"))b.backgroundPosition=-a.rectX+"px "+-a.rectY+"px";if(!b.width||a.propChanged("width","height"))b.width=
a.width+"px",b.height=a.height+"px";if(!b[e]||a.propChanged("regX","regY"))b[e]=a.regX+"px "+a.regY+"px";if(!b[d]||a.propChanged("x","y","regX","regY","scaleX","scaleY","rotation"))e=Quark.supportTransform3D?c(a,!0):c(a,!1),b[d]=e;if(!b.zIndex||a.propChanged("_depth"))b.zIndex=a._depth;null!=a.mask&&(b[Q.cssPrefix+"MaskImage"]=a.mask.getDrawable(this).style.backgroundImage,b[Q.cssPrefix+"MaskRepeat"]="no-repeat",b[Q.cssPrefix+"MaskPosition"]=a.mask.x+"px "+a.mask.y+"px");b.pointerEvents=a.eventEnabled?
"auto":"none"}};k.prototype.hide=function(a){a.getDrawable(this).style.display="none"};k.prototype.remove=function(a){var b=a.getDrawable(this),d=b.parentNode;null!=d&&d.removeChild(b);a._addedToDOM=!1}}else trace("Warn: DOMContext requires css transfrom support.")})();(function(){var c=Quark.UIDUtil={_counter:0};c.createUID=function(a){var b=a.charCodeAt(a.length-1);48<=b&&57>=b&&(a+="_");return a+this._counter++};c.displayObjectToString=function(a){for(var b;null!=a;a=a.parent){var d=null!=a.id?
a.id:a.name;b=null==b?d:d+"."+b;if(a==a.parent)break}return b}})();(function(){function c(a,b){for(var d=0;d<a.children.length;d++){var g=a.children[d];if(g.children)c(g,b);else if(null!=b){g=g.getBounds();b.globalAlpha=0.2;b.beginPath();var l=g[0];b.moveTo(l.x-0.5,l.y-0.5);for(var h=1;h<g.length;h++){var m=g[h];b.lineTo(m.x-0.5,m.y-0.5)}b.lineTo(l.x-0.5,l.y-0.5);b.stroke();b.closePath();b.globalAlpha=0.5;b.beginPath();b.rect((g.x>>0)-0.5,(g.y>>0)-0.5,g.width>>0,g.height>>0);b.stroke();b.closePath()}else g.drawable.domDrawable&&
(g.drawable.domDrawable.style.border="1px solid #f00")}}Quark.getUrlParams=function(){var a={},b=window.location.href,d=b.indexOf("?");if(0<d)for(var b=b.substring(d+1).split("\x26"),d=0,c;c=b[d];d++)c=b[d]=c.split("\x3d"),a[c[0]]=1<c.length?c[1]:!0;return a};var a=document.getElementsByTagName("head")[0],b=a.getElementsByTagName("meta"),d=0<b.length?b[b.length-1].nextSibling:a.childNodes[0];Quark.addMeta=function(b){var c=document.createElement("meta"),k;for(k in b)c.setAttribute(k,b[k]);a.insertBefore(c,
d)};Quark.toggleDebugRect=function(a){a.debug=!a.debug;a._render=a.debug?function(b){null!=b.clear&&b.clear(0,0,a.width,a.height);Quark.Stage.superClass._render.call(a,b);b=a.context.context;null!=b&&(b.save(),b.lineWidth=1,b.strokeStyle="#f00",b.globalAlpha=0.5);c(a,b);null!=b&&b.restore()}:function(b){null!=b.clear&&b.clear(0,0,a.width,a.height);Quark.Stage.superClass._render.call(a,b)}};Quark.cacheObject=function(a,b,d){var c=a.width,l=a.height,h=a.mask,m=Quark.createDOM("canvas",{width:c,height:l}),
r=new Quark.CanvasContext({canvas:m});a.mask=null;a.render(r);a.mask=h;return b?(a=new Image,a.width=c,a.height=l,a.src=m.toDataURL(d||"image/png"),a):m};Quark._helpContext=new Quark.CanvasContext({canvas:Quark.createDOM("canvas")})})();(function(){var c=Quark.Timer=function(a){this.interval=a||50;this.paused=!1;this.info={lastTime:0,currentTime:0,deltaTime:0,realDeltaTime:0};this._startTime=0;this._intervalID=null;this._listeners=[]};c.prototype.start=function(){if(null==this._intervalID){this._startTime=
this.info.lastTime=this.info.currentTime=Date.now();var a=this,b=function(){a._intervalID=setTimeout(b,a.interval);a._run()};b()}};c.prototype.stop=function(){clearTimeout(this._intervalID);this._intervalID=null;this._startTime=0};c.prototype.pause=function(){this.paused=!0};c.prototype.resume=function(){this.paused=!1};c.prototype._run=function(){if(!this.paused){var a=this.info,b=a.currentTime=Date.now();a.deltaTime=a.realDeltaTime=b-a.lastTime;for(var d=0,c=this._listeners.length,f,k;d<c;d++)f=
this._listeners[d],k=f.__runTime||0,0==k?f.step(this.info):b>k&&(f.step(this.info),this._listeners.splice(d,1),d--,c--);a.lastTime=b}};c.prototype.delay=function(a,b){var d={step:a,__runTime:Date.now()+b};this.addListener(d)};c.prototype.addListener=function(a){if(null==a||"function"!=typeof a.step)throw"Timer Error: The listener object must implement a step() method!";this._listeners.push(a)};c.prototype.removeListener=function(a){a=this._listeners.indexOf(a);-1<a&&this._listeners.splice(a,1)}})();
(function(){var c=Quark.ImageLoader=function(a){c.superClass.constructor.call(this);this.loading=!1;this._index=-1;this._loaded=0;this._images={};this._totalSize=0;this._loadHandler=Quark.delegate(this._loadHandler,this);this._addSource(a)};Quark.inherit(c,Quark.EventDispatcher);c.prototype.load=function(a){this._addSource(a);this.loading||this._loadNext()};c.prototype._addSource=function(a){if(a){a=a instanceof Array?a:[a];for(var b=0;b<a.length;b++)this._totalSize+=a[b].size||0;this._source=this._source?
this._source.concat(a):a}};c.prototype._loadNext=function(){this._index++;if(this._index>=this._source.length)this.dispatchEvent({type:"complete",target:this,images:this._images}),this._source=[],this.loading=!1,this._index=-1;else{var a=new Image;a.onload=this._loadHandler;a.src=this._source[this._index].src;this.loading=!0}};c.prototype._loadHandler=function(a){this._loaded++;var b=this._source[this._index];b.image=a.target;this._images[b.id||b.src]=b;this.dispatchEvent({type:"loaded",target:this,
image:b});this._loadNext()};c.prototype.getLoaded=function(){return this._loaded};c.prototype.getTotal=function(){return this._source.length};c.prototype.getLoadedSize=function(){var a=0,b;for(b in this._images)a+=this._images[b].size||0;return a};c.prototype.getTotalSize=function(){return this._totalSize}})();(function(){var c=Quark.Tween=function(b,d,c){this.target=b;this.delay=this.time=0;this.reverse=this.loop=this.paused=!1;this.interval=0;this.ease=a.Linear.EaseNone;this.onComplete=this.onUpdate=
this.onStart=this.next=null;this._oldProps={};this._newProps={};this._deltaProps={};this._pausedStartTime=this._pausedTime=this._lastTime=this._startTime=0;this._reverseFlag=1;this._frameCount=this._frameTotal=0;for(var f in d){var k=b[f],g=d[f];void 0!==k&&("number"==typeof k&&"number"==typeof g)&&(this._oldProps[f]=k,this._newProps[f]=g,this._deltaProps[f]=g-k)}for(f in c)this[f]=c[f]};c.prototype.setProps=function(a,d){for(var c in a)this.target[c]=this._oldProps[c]=a[c];for(c in d)this._newProps[c]=
d[c],this._deltaProps[c]=d[c]-this.target[c]};c.prototype._init=function(){this._startTime=Date.now()+this.delay;this._pausedTime=0;0<this.interval&&(this._frameTotal=Math.round(this.time/this.interval));c.add(this)};c.prototype.start=function(){this._init();this.paused=!1};c.prototype.stop=function(){c.remove(this)};c.prototype.pause=function(){this.paused=!0;this._pausedStartTime=Date.now()};c.prototype.resume=function(){this.paused=!1;this._pausedTime+=Date.now()-this._pausedStartTime};c.prototype._update=
function(){if(!this.paused){var a=Date.now(),d=a-this._startTime-this._pausedTime;if(!(0>d)){if(0==this._lastTime&&null!=this.onStart)this.onStart(this);this._lastTime=a;a=0<this._frameTotal?++this._frameCount/this._frameTotal:d/this.time;1<a&&(a=1);var d=this.ease(a),e;for(e in this._oldProps)this.target[e]=this._oldProps[e]+this._deltaProps[e]*this._reverseFlag*d;if(null!=this.onUpdate)this.onUpdate(this,d);if(1<=a){if(this.reverse)e=this._oldProps,this._oldProps=this._newProps,this._newProps=e,
this._startTime=Date.now(),this._frameCount=0,this._reverseFlag*=-1,this.loop||(this.reverse=!1);else if(this.loop){for(e in this._oldProps)this.target[e]=this._oldProps[e];this._startTime=Date.now();this._frameCount=0}else c.remove(this),e=this.next,null!=e&&(e instanceof c?(a=e,e=null):a=e.shift(),null!=a&&(a.next=e,a.start()));if(null!=this.onComplete)this.onComplete(this)}}}};c._tweens=[];c.step=function(){for(var a=this._tweens,d=a.length;0<=--d;)a[d]._update()};c.add=function(a){-1==this._tweens.indexOf(a)&&
this._tweens.push(a);return this};c.remove=function(a){var d=this._tweens;a=d.indexOf(a);-1<a&&d.splice(a,1);return this};c.to=function(a,d,e){a=new c(a,d,e);a._init();return a};c.from=function(a,d,e){d=new c(a,d,e);e=d._oldProps;d._oldProps=d._newProps;d._newProps=e;d._reverseFlag=-1;for(var f in d._oldProps)a[f]=d._oldProps[f];d._init();return d};var a=Quark.Easing={Linear:{},Quadratic:{},Cubic:{},Quartic:{},Quintic:{},Sinusoidal:{},Exponential:{},Circular:{},Elastic:{},Back:{},Bounce:{}};a.Linear.EaseNone=
function(a){return a};a.Quadratic.EaseIn=function(a){return a*a};a.Quadratic.EaseOut=function(a){return-a*(a-2)};a.Quadratic.EaseInOut=function(a){return 1>(a*=2)?0.5*a*a:-0.5*(--a*(a-2)-1)};a.Cubic.EaseIn=function(a){return a*a*a};a.Cubic.EaseOut=function(a){return--a*a*a+1};a.Cubic.EaseInOut=function(a){return 1>(a*=2)?0.5*a*a*a:0.5*((a-=2)*a*a+2)};a.Quartic.EaseIn=function(a){return a*a*a*a};a.Quartic.EaseOut=function(a){return-(--a*a*a*a-1)};a.Quartic.EaseInOut=function(a){return 1>(a*=2)?0.5*
a*a*a*a:-0.5*((a-=2)*a*a*a-2)};a.Quintic.EaseIn=function(a){return a*a*a*a*a};a.Quintic.EaseOut=function(a){return(a-=1)*a*a*a*a+1};a.Quintic.EaseInOut=function(a){return 1>(a*=2)?0.5*a*a*a*a*a:0.5*((a-=2)*a*a*a*a+2)};a.Sinusoidal.EaseIn=function(a){return-Math.cos(a*Math.PI/2)+1};a.Sinusoidal.EaseOut=function(a){return Math.sin(a*Math.PI/2)};a.Sinusoidal.EaseInOut=function(a){return-0.5*(Math.cos(Math.PI*a)-1)};a.Exponential.EaseIn=function(a){return 0==a?0:Math.pow(2,10*(a-1))};a.Exponential.EaseOut=
function(a){return 1==a?1:-Math.pow(2,-10*a)+1};a.Exponential.EaseInOut=function(a){return 0==a?0:1==a?1:1>(a*=2)?0.5*Math.pow(2,10*(a-1)):0.5*(-Math.pow(2,-10*(a-1))+2)};a.Circular.EaseIn=function(a){return-(Math.sqrt(1-a*a)-1)};a.Circular.EaseOut=function(a){return Math.sqrt(1- --a*a)};a.Circular.EaseInOut=function(a){return 1>(a/=0.5)?-0.5*(Math.sqrt(1-a*a)-1):0.5*(Math.sqrt(1-(a-=2)*a)+1)};a.Elastic.EaseIn=function(a){var d,c=0.1,f=0.4;if(0==a)return 0;if(1==a)return 1;f||(f=0.3);!c||1>c?(c=1,
d=f/4):d=f/(2*Math.PI)*Math.asin(1/c);return-(c*Math.pow(2,10*(a-=1))*Math.sin((a-d)*2*Math.PI/f))};a.Elastic.EaseOut=function(a){var d,c=0.1,f=0.4;if(0==a)return 0;if(1==a)return 1;f||(f=0.3);!c||1>c?(c=1,d=f/4):d=f/(2*Math.PI)*Math.asin(1/c);return c*Math.pow(2,-10*a)*Math.sin((a-d)*2*Math.PI/f)+1};a.Elastic.EaseInOut=function(a){var d,c=0.1,f=0.4;if(0==a)return 0;if(1==a)return 1;f||(f=0.3);!c||1>c?(c=1,d=f/4):d=f/(2*Math.PI)*Math.asin(1/c);return 1>(a*=2)?-0.5*c*Math.pow(2,10*(a-=1))*Math.sin((a-
d)*2*Math.PI/f):0.5*c*Math.pow(2,-10*(a-=1))*Math.sin((a-d)*2*Math.PI/f)+1};a.Back.EaseIn=function(a){return a*a*(2.70158*a-1.70158)};a.Back.EaseOut=function(a){return(a-=1)*a*(2.70158*a+1.70158)+1};a.Back.EaseInOut=function(a){return 1>(a*=2)?0.5*a*a*(3.5949095*a-2.5949095):0.5*((a-=2)*a*(3.5949095*a+2.5949095)+2)};a.Bounce.EaseIn=function(b){return 1-a.Bounce.EaseOut(1-b)};a.Bounce.EaseOut=function(a){return(a/=1)<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+0.75:a<2.5/2.75?7.5625*(a-=2.25/
2.75)*a+0.9375:7.5625*(a-=2.625/2.75)*a+0.984375};a.Bounce.EaseInOut=function(b){return 0.5>b?0.5*a.Bounce.EaseIn(2*b):0.5*a.Bounce.EaseOut(2*b-1)+0.5}})();(function(){var c=Quark.Audio=function(a,b,d,e){c.superClass.constructor.call(this);this.src=a;this.autoPlay=b&&d;this.loop=e;this._playing=this._loaded=!1;this._evtHandler=Quark.delegate(this._evtHandler,this);this._element=document.createElement("audio");this._element.preload=b;this._element.src=a;b&&this.load()};Quark.inherit(c,Quark.EventDispatcher);
c.prototype.load=function(){this._element.addEventListener("progress",this._evtHandler,!1);this._element.addEventListener("ended",this._evtHandler,!1);this._element.addEventListener("error",this._evtHandler,!1);try{this._element.load()}catch(a){trace(a)}};c.prototype._evtHandler=function(a){if("progress"==a.type){var b=0,d=0,c=a.target.buffered;if(c&&0<c.length)for(b=c.length-1;0<=b;b--)d=c.end(b)-c.start(b);1<=d/a.target.duration&&(this._element.removeEventListener("progress",this._evtHandler),this._element.removeEventListener("error",
this._evtHandler),this._loaded=!0,this.dispatchEvent({type:"loaded",target:this}),this.autoPlay&&this.play())}else"ended"==a.type?(this.dispatchEvent({type:"ended",target:this}),this.loop?this.play():this._playing=!1):"error"==a.type&&trace("Quark.Audio Error: "+a.target.src)};c.prototype.play=function(){this._loaded?(this._element.play(),this._playing=!0):(this.autoPlay=!0,this.load())};c.prototype.stop=function(){this._playing&&(this._element.pause(),this._playing=!1)};c.prototype.loaded=function(){return this._loaded};
c.prototype.playing=function(){return this._playing}})();(function(){var c=Quark.Drawable=function(a,b){this.domDrawable=this.rawDrawable=null;this.set(a,b)};c.prototype.get=function(a,b){if(null==b||null!=b.canvas.getContext)return this.rawDrawable;null==this.domDrawable&&(this.domDrawable=Quark.createDOMDrawable(a,{image:this.rawDrawable}));return this.domDrawable};c.prototype.set=function(a,b){var d;d=null==a?!1:a instanceof HTMLImageElement||a instanceof HTMLCanvasElement||a instanceof HTMLVideoElement;
d&&(this.rawDrawable=a);!0===b?this.domDrawable=a:this.domDrawable&&(this.domDrawable.style.backgroundImage="url("+this.rawDrawable.src+")")}})();(function(){var c=Quark.DisplayObject=function(a){this.id=Quark.UIDUtil.createUID("DisplayObject");this.name=null;this.height=this.width=this.regY=this.regX=this.y=this.x=0;this.scaleY=this.scaleX=this.alpha=1;this.rotation=0;this.transformEnabled=this.eventEnabled=this.visible=!0;this.useHandCursor=!1;this.context=this.parent=this.drawable=this.mask=this.polyArea=
null;this._depth=0;this._lastState={};this._stateList="x y regX regY width height alpha scaleX scaleY rotation visible _depth".split(" ");Quark.merge(this,a,!0);a.mixin&&Quark.merge(this,a.mixin,!1);c.superClass.constructor.call(this,a)};Quark.inherit(c,Quark.EventDispatcher);c.prototype.setDrawable=function(a){null==this.drawable?this.drawable=new Quark.Drawable(a):this.drawable.rawDrawable!=a&&this.drawable.set(a)};c.prototype.getDrawable=function(a){return this._cache||this.drawable&&this.drawable.get(this,
a)};c.prototype._update=function(a){this.update(a)};c.prototype.update=function(a){return!0};c.prototype._render=function(a){a=this.context||a;!this.visible||0>=this.alpha?(null!=a.hide&&a.hide(this),this.saveState(["visible","alpha"])):(a.startDraw(),a.transform(this),this.render(a),a.endDraw(),this.saveState())};c.prototype.render=function(a){a.draw(this,0,0,this.width,this.height,0,0,this.width,this.height)};c.prototype.saveState=function(a){a=a||this._stateList;for(var b=this._lastState,d=0,c=
a.length;d<c;d++){var f=a[d];b["last"+f]=this[f]}};c.prototype.getState=function(a){return this._lastState["last"+a]};c.prototype.propChanged=function(a){for(var b=0<arguments.length?arguments:this._stateList,d=0,c=b.length;d<c;d++){var f=b[d];if(this._lastState["last"+f]!=this[f])return!0}return!1};c.prototype.hitTestPoint=function(a,b,d){return Quark.hitTestPoint(this,a,b,d)};c.prototype.hitTestObject=function(a,b){return Quark.hitTestObject(this,a,b)};c.prototype.localToGlobal=function(a,b){var d=
this.getConcatenatedMatrix();return{x:d.tx+a,y:d.ty+b}};c.prototype.globalToLocal=function(a,b){var d=this.getConcatenatedMatrix().invert();return{x:d.tx+a,y:d.ty+b}};c.prototype.localToTarget=function(a,b,d){a=this.localToGlobal(a,b);return d.globalToLocal(a.x,a.y)};c.prototype.getConcatenatedMatrix=function(a){var b=new Quark.Matrix(1,0,0,1,0,0);if(a==this)return b;for(var d=this;null!=d.parent&&d.parent!=a;d=d.parent){var c=1,f=0;0!=d.rotation%360&&(f=d.rotation*Quark.DEG_TO_RAD,c=Math.cos(f),
f=Math.sin(f));0!=d.regX&&(b.tx-=d.regX);0!=d.regY&&(b.ty-=d.regY);b.concat(new Quark.Matrix(c*d.scaleX,f*d.scaleX,-f*d.scaleY,c*d.scaleY,d.x,d.y))}return b};c.prototype.getBounds=function(){var a=this.width,b=this.height,d=this.getConcatenatedMatrix(),a=this.polyArea||[{x:0,y:0},{x:a,y:0},{x:a,y:b},{x:0,y:b}],b=[],c=a.length,f,k,g,l,h;f=d.transformPoint(a[0],!0,!0);k=g=f.x;l=h=f.y;b[0]=f;for(var m=1;m<c;m++)f=d.transformPoint(a[m],!0,!0),k>f.x?k=f.x:g<f.x&&(g=f.x),l>f.y?l=f.y:h<f.y&&(h=f.y),b[m]=
f;b.x=k;b.y=l;b.width=g-k;b.height=h-l;return b};c.prototype.getCurrentWidth=function(){return Math.abs(this.width*this.scaleX)};c.prototype.getCurrentHeight=function(){return Math.abs(this.height*this.scaleY)};c.prototype.getStage=function(){for(var a=this;a.parent;)a=a.parent;return a instanceof Quark.Stage?a:null};Quark.DisplayObject.prototype.cache=function(a,b){return this._cache=Quark.cacheObject(this,a,b)};Quark.DisplayObject.prototype.uncache=function(){this._cache=null};Quark.DisplayObject.prototype.toImage=
function(a){return Quark.cacheObject(this,!0,a)};c.prototype.toString=function(){return Quark.UIDUtil.displayObjectToString(this)}})();(function(){var c=Quark.DisplayObjectContainer=function(a){this.eventChildren=!0;this.autoSize=!1;this.children=[];a=a||{};c.superClass.constructor.call(this,a);this.id=a.id||Quark.UIDUtil.createUID("DisplayObjectContainer");this.setDrawable(a.drawable||a.image||null);if(a.children)for(var b=0;b<a.children.length;b++)this.addChild(a.children[b])};Quark.inherit(c,Quark.DisplayObject);
c.prototype.addChildAt=function(a,b){0>b?b=0:b>this.children.length&&(b=this.children.length);var d=this.getChildIndex(a);if(-1!=d){if(d==b)return this;this.children.splice(d,1)}else a.parent&&a.parent.removeChild(a);this.children.splice(b,0,a);a.parent=this;if(this.autoSize){var d=new Quark.Rectangle(0,0,this.rectWidth||this.width,this.rectHeight||this.height),c=new Quark.Rectangle(a.x,a.y,a.rectWidth||a.width,a.rectHeight||a.height);d.union(c);this.width=d.width;this.height=d.height}return this};
c.prototype.addChild=function(a){for(var b=this.children.length,d=0;d<arguments.length;d++)a=arguments[d],this.addChildAt(a,b+d);return this};c.prototype.removeChildAt=function(a){if(0>a||a>=this.children.length)return!1;var b=this.children[a];if(null!=b){var d=this.getStage();null!=d&&d.context.remove(b);b.parent=null}this.children.splice(a,1);return!0};c.prototype.removeChild=function(a){return this.removeChildAt(this.children.indexOf(a))};c.prototype.removeAllChildren=function(){for(;0<this.children.length;)this.removeChildAt(0)};
c.prototype.getChildAt=function(a){return 0>a||a>=this.children.length?null:this.children[a]};c.prototype.getChildIndex=function(a){return this.children.indexOf(a)};c.prototype.setChildIndex=function(a,b){if(a.parent==this){var d=this.children.indexOf(a);b!=d&&(this.children.splice(d,1),this.children.splice(b,0,a))}};c.prototype.swapChildren=function(a,b){var d=this.getChildIndex(a),c=this.getChildIndex(b);this.children[d]=b;this.children[c]=a};c.prototype.swapChildrenAt=function(a,b){var d=this.getChildAt(a),
c=this.getChildAt(b);this.children[a]=c;this.children[b]=d};c.prototype.getChildById=function(a){for(var b=0,d=this.children.length;b<d;b++){var c=this.children[b];if(c.id==a)return c}return null};c.prototype.removeChildById=function(a){for(var b=0,d=this.children.length;b<d;b++)if(this.children[b].id==a)return this.removeChildAt(b);return null};c.prototype.sortChildren=function(a){if("string"==typeof a){var b=a;a=function(a,c){return c[b]-a[b]}}this.children.sort(a)};c.prototype.contains=function(a){return-1!=
this.getChildIndex(a)};c.prototype.getNumChildren=function(){return this.children.length};c.prototype._update=function(a){var b=!0;null!=this.update&&(b=this.update(a));if(!1!==b)for(var b=this.children.slice(0),d=0,c=b.length;d<c;d++){var f=b[d];f._depth=d+1;f._update(a)}};c.prototype.render=function(a){c.superClass.render.call(this,a);for(var b=0,d=this.children.length;b<d;b++)this.children[b]._render(a)};c.prototype.getObjectUnderPoint=function(a,b,d,c){if(c)var f=[];for(var k=this.children.length-
1;0<=k;k--){var g=this.children[k];if(!(null==g||!g.eventEnabled&&void 0==g.children||!g.visible||0>=g.alpha))if(void 0!=g.children&&g.eventChildren&&0<g.getNumChildren()){var l=g.getObjectUnderPoint(a,b,d,c);if(l)if(c)0<l.length&&(f=f.concat(l));else return l;else if(0<=g.hitTestPoint(a,b,d))if(c)f.push(g);else return g}else if(0<=g.hitTestPoint(a,b,d))if(c)f.push(g);else return g}return c?f:null}})();(function(){var c=Quark.Stage=function(a){this.stageY=this.stageX=0;this.paused=!1;this._eventTarget=
null;a=a||{};c.superClass.constructor.call(this,a);this.id=a.id||Quark.UIDUtil.createUID("Stage");if(null==this.context)throw"Quark.Stage Error: context is required.";this.updatePosition()};Quark.inherit(c,Quark.DisplayObjectContainer);c.prototype.step=function(a){this.paused||(this._update(a),this._render(this.context))};c.prototype._update=function(a){for(var b=this.children.slice(0),d=0,c=b.length;d<c;d++){var f=b[d];f._depth=d+1;f._update(a)}null!=this.update&&this.update(a)};c.prototype._render=
function(a){null!=a.clear&&a.clear(0,0,this.width,this.height);c.superClass._render.call(this,a)};c.prototype.dispatchEvent=function(a){var b=a.pageX||a.clientX,d=a.pageY||a.clientY,b=(b-this.stageX)/this.scaleX,d=(d-this.stageY)/this.scaleY,e=this.getObjectUnderPoint(b,d,!0),f=this._eventTarget;a.eventX=b;a.eventY=d;b="mouseout"==a.type&&!this.context.canvas.contains(a.relatedTarget);if(null!=f&&(f!=e||b))a.lastEventTarget=f,(d=b||null==e||"mousemove"==a.type?"mouseout":"touchmove"==a.type?"touchout":
null)&&f.dispatchEvent({type:d}),this._eventTarget=null;null!=e&&(e.eventEnabled&&"mouseout"!=a.type)&&(a.eventTarget=f=this._eventTarget=e,e.dispatchEvent(a));Quark.supportTouch||(this.context.canvas.style.cursor=f&&f.useHandCursor&&f.eventEnabled?"pointer":"");(b||"mouseout"!=a.type)&&c.superClass.dispatchEvent.call(this,a)};c.prototype.updatePosition=function(){var a=Quark.getElementOffset(this.context.canvas);this.stageX=a.left;this.stageY=a.top}})();(function(){var c=Quark.Bitmap=function(a){this.image=
null;this.rectHeight=this.rectWidth=this.rectY=this.rectX=0;a=a||{};c.superClass.constructor.call(this,a);this.id=a.id||Quark.UIDUtil.createUID("Bitmap");this.setRect(a.rect||[0,0,this.image.width,this.image.height]);this.setDrawable(this.image);this._stateList.push("rectX","rectY","rectWidth","rectHeight")};Quark.inherit(c,Quark.DisplayObject);c.prototype.setRect=function(a){this.rectX=a[0];this.rectY=a[1];this.rectWidth=this.width=a[2];this.rectHeight=this.height=a[3]};c.prototype.render=function(a){a.draw(this,
this.rectX,this.rectY,this.rectWidth,this.rectHeight,0,0,this.width,this.height)}})();(function(){var c=Quark.MovieClip=function(a){this.interval=0;this.useFrames=this.paused=!1;this.currentFrame=0;this._frames=[];this._frameLabels={};this._frameDisObj=null;this._displayedCount=0;a=a||{};c.superClass.constructor.call(this,a);this.id=a.id||Quark.UIDUtil.createUID("MovieClip");a.frames&&this.addFrame(a.frames)};Quark.inherit(c,Quark.Bitmap);c.prototype.addFrame=function(a){var b=this._frames.length;
if(a instanceof Array)for(var d=0;d<a.length;d++)this.setFrame(a[d],b+d);else this.setFrame(a,b);return this};c.prototype.setFrame=function(a,b){void 0==b||b>this._frames.length?b=this._frames.length:0>b&&(b=0);this._frames[b]=a;a.label&&(this._frameLabels[a.label]=a);void 0==a.interval&&(a.interval=this.interval);0==b&&0==this.currentFrame&&this.setRect(a.rect)};c.prototype.getFrame=function(a){return"number"==typeof a?this._frames[a]:this._frameLabels[a]};c.prototype.play=function(){this.paused=
!1};c.prototype.stop=function(){this.paused=!0};c.prototype.gotoAndStop=function(a){this.currentFrame=this.getFrameIndex(a);this.paused=!0};c.prototype.gotoAndPlay=function(a){this.currentFrame=this.getFrameIndex(a);this.paused=!1};c.prototype.getFrameIndex=function(a){if("number"==typeof a)return a;a=this._frameLabels[a];for(var b=this._frames,d=0;d<b.length;d++)if(a==b[d])return d;return-1};c.prototype.nextFrame=function(a){var b=this._frames[this.currentFrame];0<b.interval&&(a=this._displayedCount+
a,this._displayedCount=b.interval>a?a:0);if(0<=b.jump||"string"==typeof b.jump)if(0==this._displayedCount||!b.interval)return this.currentFrame=this.getFrameIndex(b.jump);return 0<b.interval&&0<this._displayedCount?this.currentFrame:this.currentFrame>=this._frames.length-1?this.currentFrame=0:++this.currentFrame};c.prototype.getNumFrames=function(){return this._frames.length};c.prototype._update=function(a){var b=this._frames[this.currentFrame];b.stop?this.stop():(this.paused||(b=this._frames[this.nextFrame(this.useFrames?
1:a&&a.deltaTime)]),this.setRect(b.rect),c.superClass._update.call(this,a))};c.prototype.render=function(a){var b=this._frames[this.currentFrame].rect;a.draw(this,b[0],b[1],b[2],b[3],0,0,this.width,this.height)}})();(function(){var c=Quark.Button=function(a){this.state=c.UP;this.enabled=!0;a=a||{};c.superClass.constructor.call(this,a);this.id=a.id||Quark.UIDUtil.createUID("Button");this._skin=new Quark.MovieClip({id:"skin",image:a.image});this.addChild(this._skin);this._skin.stop();this.eventChildren=
!1;void 0===a.useHandCursor&&(this.useHandCursor=!0);a.up&&this.setUpState(a.up);a.over&&this.setOverState(a.over);a.down&&this.setDownState(a.down);a.disabled&&this.setDisabledState(a.disabled)};Quark.inherit(c,Quark.DisplayObjectContainer);c.UP="up";c.OVER="over";c.DOWN="down";c.DISABLED="disabled";c.prototype.setUpState=function(a){a.label=c.UP;this._skin.setFrame(a,0);this.upState=a;return this};c.prototype.setOverState=function(a){a.label=c.OVER;this._skin.setFrame(a,1);this.overState=a;return this};
c.prototype.setDownState=function(a){a.label=c.DOWN;this._skin.setFrame(a,2);this.downState=a;return this};c.prototype.setDisabledState=function(a){a.label=c.DISABLED;this._skin.setFrame(a,3);this.disabledState=a;return this};c.prototype.setEnabled=function(a){if(this.enabled==a)return this;(this.eventEnabled=this.enabled=a)?3==this._skin.currentFrame&&this._skin.gotoAndStop(c.UP):this.disabledState?this._skin.gotoAndStop(c.DISABLED):this._skin.gotoAndStop(c.UP);return this};c.prototype.changeState=
function(a){if(this.state!=a){this.state=a;switch(a){case c.OVER:case c.DOWN:case c.UP:this.enabled||(this.eventEnabled=this.enabled=!0);this._skin.gotoAndStop(a);break;case c.DISABLED:this.setEnabled(!1)}return this}};c.prototype.dispatchEvent=function(a){if(this.enabled){switch(a.type){case "mousemove":this.overState&&this.changeState(c.OVER);break;case "mousedown":case "touchstart":case "touchmove":this.downState&&this.changeState(c.DOWN);break;case "mouseup":this.overState?this.changeState(c.OVER):
this.changeState(c.UP);break;case "mouseout":case "touchout":case "touchend":this.upState&&this.changeState(c.UP)}c.superClass.dispatchEvent.call(this,a)}};c.prototype.setDrawable=function(a){c.superClass.setDrawable.call(this,null)}})();(function(){var c=Quark.Graphics=function(a){this.lineWidth=1;this.strokeStyle="0";this.lineAlpha=1;this.lineJoin=this.lineCap=null;this.miterLimit=10;this.hasFill=this.hasStroke=!1;this.fillStyle="0";this.fillAlpha=1;a=a||{};c.superClass.constructor.call(this,a);
this.id=Quark.UIDUtil.createUID("Graphics");this._actions=[];this._cache=null};Quark.inherit(c,Quark.DisplayObject);c.prototype.lineStyle=function(a,b,d,c,f,k){this._addAction(["lineWidth",this.lineWidth=a||1]);this._addAction(["strokeStyle",this.strokeStyle=b||"0"]);this._addAction(["lineAlpha",this.lineAlpha=d||1]);void 0!=c&&this._addAction(["lineCap",this.lineCap=c]);void 0!=f&&this._addAction(["lineJoin",this.lineJoin=f]);void 0!=k&&this._addAction(["miterLimit",this.miterLimit=k]);this.hasStroke=
!0;return this};c.prototype.beginFill=function(a,b){this._addAction(["fillStyle",this.fillStyle=a]);this._addAction(["fillAlpha",this.fillAlpha=b||1]);this.hasFill=!0;return this};c.prototype.endFill=function(){this.hasStroke&&this._addAction(["stroke"]);this.hasFill&&this._addAction(["fill"]);return this};c.prototype.beginLinearGradientFill=function(a,b,d,e,f,k){a=c._getContext().createLinearGradient(a,b,d,e);b=0;for(d=f.length;b<d;b++)a.addColorStop(k[b],f[b]);return this._addAction(["fillStyle",
this.fillStyle=a])};c.prototype.beginRadialGradientFill=function(a,b,d,e,f,k,g,l){a=c._getContext().createRadialGradient(a,b,d,e,f,k);b=0;for(d=g.length;b<d;b++)a.addColorStop(l[b],g[b]);return this._addAction(["fillStyle",this.fillStyle=a])};c.prototype.beginBitmapFill=function(a,b){var d=c._getContext().createPattern(a,b||"");return this._addAction(["fillStyle",this.fillStyle=d])};c.prototype.beginPath=function(){return this._addAction(["beginPath"])};c.prototype.closePath=function(){return this._addAction(["closePath"])};
c.prototype.drawRect=function(a,b,d,c){return this._addAction(["rect",a,b,d,c])};c.prototype.drawRoundRectComplex=function(a,b,d,c,f,k,g,l){this._addAction(["moveTo",a+f,b]);this._addAction(["lineTo",a+d-k,b]);this._addAction(["arc",a+d-k,b+k,k,-Math.PI/2,0,!1]);this._addAction(["lineTo",a+d,b+c-g]);this._addAction(["arc",a+d-g,b+c-g,g,0,Math.PI/2,!1]);this._addAction(["lineTo",a+l,b+c]);this._addAction(["arc",a+l,b+c-l,l,Math.PI/2,Math.PI,!1]);this._addAction(["lineTo",a,b+f]);this._addAction(["arc",
a+f,b+f,f,Math.PI,3*Math.PI/2,!1]);return this};c.prototype.drawRoundRect=function(a,b,c,e,f){return this.drawRoundRectComplex(a,b,c,e,f,f,f,f)};c.prototype.drawCircle=function(a,b,c){return this._addAction(["arc",a+c,b+c,c,0,2*Math.PI,0])};c.prototype.drawEllipse=function(a,b,c,e){if(c==e)return this.drawCircle(a,b,c);c/=2;e/=2;var f=0.5522847498307933*c,k=0.5522847498307933*e;a+=c;b+=e;this._addAction(["moveTo",a+c,b]);this._addAction(["bezierCurveTo",a+c,b-k,a+f,b-e,a,b-e]);this._addAction(["bezierCurveTo",
a-f,b-e,a-c,b-k,a-c,b]);this._addAction(["bezierCurveTo",a-c,b+k,a-f,b+e,a,b+e]);this._addAction(["bezierCurveTo",a+f,b+e,a+c,b+k,a+c,b]);return this};c.prototype.drawSVGPath=function(a){a=a.split(/,| (?=[a-zA-Z])/);this._addAction(["beginPath"]);for(var b=0,c=a.length;b<c;b++){var e=a[b],f=e[0].toUpperCase(),e=e.substring(1).split(/,| /);0==e[0].length&&e.shift();switch(f){case "M":this._addAction(["moveTo",e[0],e[1]]);break;case "L":this._addAction(["lineTo",e[0],e[1]]);break;case "C":this._addAction(["bezierCurveTo",
e[0],e[1],e[2],e[3],e[4],e[5]]);break;case "Z":this._addAction(["closePath"])}}return this};c.prototype._draw=function(a){a.beginPath();for(var b=0,c=this._actions.length;b<c;b++){var e=this._actions[b],f=e[0],k=1<e.length?e.slice(1):null;"function"==typeof a[f]?a[f].apply(a,k):a[f]=e[1]}};c.prototype.getDrawable=function(a){null==this.drawable&&this.setDrawable(this.toImage());return this.drawable.get(this,a)};c.prototype.cache=function(a){var b=Quark.createDOM("canvas",{width:this.width,height:this.height});
this._draw(b.getContext("2d"));this._cache=b;a&&(this._cache=this.toImage());return this._cache};c.prototype.uncache=function(){this._cache=null};c.prototype.toImage=function(a){var b=this._cache||this.cache(!0);if(b instanceof HTMLImageElement)return b;var c=new Image;c.src=b.toDataURL(a||"image/png");c.width=this.width;c.height=this.height;return c};c.prototype.clear=function(){this._actions.length=0;this._cache=null;this.lineWidth=1;this.strokeStyle="0";this.lineAlpha=1;this.lineJoin=this.lineCap=
null;this.miterLimit=10;this.hasStroke=!1;this.fillStyle="0";this.fillAlpha=1};c.prototype._addAction=function(a){this._actions.push(a);return this};c._getContext=function(){var a=Quark.createDOM("canvas").getContext("2d");this._getContext=function(){return a};return a}})();(function(){var c=Quark.Text=function(a){this.text="";this.font="12px arial";this.color="#000";this.textAlign="start";this.outline=!1;this.maxWidth=1E4;this.lineWidth=null;this.lineSpacing=0;this.fontMetrics=null;a=a||{};c.superClass.constructor.call(this,
a);this.id=Quark.UIDUtil.createUID("Text");null==this.fontMetrics&&(this.fontMetrics=c.getFontMetrics(this.font))};Quark.inherit(c,Quark.DisplayObject);c.prototype._draw=function(a){if(this.text&&0!=this.text.length){a.font=this.font;a.textAlign=this.textAlign;a.textBaseline="top";this.outline?a.strokeStyle=this.color:a.fillStyle=this.color;var b=this.text.split(/\r\n|\r|\n|<br(?:[ \/])*>/),c=0,e=this.fontMetrics.height+this.lineSpacing;this.width=this.lineWidth||0;for(var f=0,k=b.length;f<k;f++){var g=
b[f],l=a.measureText(g).width;if(null==this.lineWidth||l<this.lineWidth)l>this.width&&(this.width=l),this._drawTextLine(a,g,c);else{for(var g=g.split(/([^\x00-\xff]|\b)/),l=g[0],h=1,m=g.length;h<m;h++){var r=g[h];r&&0!=r.length&&(a.measureText(l+r).width>this.lineWidth?(this._drawTextLine(a,l,c),c+=e,l=r):l+=r)}this._drawTextLine(a,l,c)}c+=e}this.height=c}};c.prototype._drawTextLine=function(a,b,c){var e=0;switch(this.textAlign){case "center":e=0.5*this.width;break;case "right":case "end":e=this.width}this.outline?
a.strokeText(b,e,c,this.maxWidth):a.fillText(b,e,c,this.maxWidth)};c.prototype.setFont=function(a,b){this.font!=a&&(this.font=a,b||(this.fontMetrics=c.getFontMetrics(this.font)))};c.prototype.render=function(a){if(a instanceof Quark.DOMContext){var b=this.getDrawable(a),d=b.style;d.font=this.font;d.textAlign=this.textAlign;d.color=this.color;d.width=this.width+"px";d.height=this.height+"px";d.lineHeight=this.fontMetrics.height+this.lineSpacing+"px";b.innerHTML=this.text}c.superClass.render.call(this,
a)};c.prototype.getDrawable=function(a){null==this.drawable&&this.setDrawable(Quark.createDOM("div"),!0);return this.drawable.get(this,a)};c.getFontMetrics=function(a){var b={};a=Quark.createDOM("div",{style:{font:a,position:"absolute"},innerHTML:"M"});document.body.appendChild(a);b.height=a.offsetHeight;a.innerHTML='\x3cdiv style\x3d"display:inline-block; width:1px; height:1px;"\x3e\x3c/div\x3e';var c=a.childNodes[0];b.ascent=c.offsetTop+c.offsetHeight;b.descent=b.height-b.ascent;document.body.removeChild(a);
return b}})()})();(function(){(function(){window.Motion||(window.Motion=window.mo={version:"1.1",add:function(c,a){var b=window,d=arguments.callee,e=null;/^([\w\.]+)(?:\:([\w\.]+))?\s*$/.test(c);var f=RegExp.$1.split("."),k=RegExp.$2.split(".");c=f.pop();for(var g=/[A-Z]/.test(c.substr(0,1)),l=function(){var a=arguments.callee.prototype.init;"function"==typeof a&&arguments.callee.caller!=d&&a&&a.apply(this,arguments)},h=0;h<f.length;h++)var m=f[h],b=b[m]||(b[m]={});if(""!=k[0]){e=window;for(h=0;h<
k.length;h++)if(e=e[k[h]],!e){e=null;break}}g&&"function"==typeof a?(e&&(l.prototype=new e,l.prototype.superClass=e),b[c]=l,l.prototype.constructor=l,a.call(b[c].prototype)):b[c]=a}})})()})();(function(){Motion.add("mo.Base",function(){this.constructor=function(){};this.on=function(c,a){box=Zepto(this);return box.on.apply(box,arguments)};this.off=function(c,a){box=Zepto(this);return box.off.apply(box,arguments)};this.trigger=function(c,a){var b=Zepto(this);return b.triggerHandler.apply(b,arguments)}})})();
(function(){Motion.add("mo.ImageEditor:mo.Base",function(){var c={},a=this.constructor;a.config={width:320,height:320,fps:60};this.init=function(b){b=this.config=Zepto.extend(!0,{},a.config,b);this.effect&&this.on(this.effect);b.event&&this.on(b.event);if(!1!==this.trigger("beforeinit")){var d=Quark.createDOM("canvas",{width:b.width,height:b.height,style:{backgroundColor:"#fff"}}),d=$(d).appendTo(b.container)[0],e=new Quark.CanvasContext({canvas:d});this.stage=new Quark.Stage({width:b.width,height:b.height,
context:e});this.canvas=d;this.context=e;(this.em=new Quark.EventManager).registerStage(this.stage,["touchstart","touchmove","touchend"],!0,!0);this.stage.stageX=b.stageX!==window.undefined?b.stageX:this.stage.stageX;this.stage.stageY=b.stageY!==window.undefined?b.stageY:this.stage.stageY;d=new Quark.Timer(1E3/b.fps);d.addListener(this.stage);d.addListener(Quark.Tween);d.start();d=new Q.Graphics({width:b.width,height:b.height});d.beginFill("#fff").drawRect(0,0,b.width,b.height).endFill().cache();
this.stage.addChild(d);c.attach.call(this)}};c.attach=function(){var a=this,c=a.config;c.trigger.on("change",function(e){a.trigger("beforechange");e=this.files[0];if(e.type&&!/image\/\w+/.test(e.type))return alert("\u8bf7\u9009\u62e9\u56fe\u7247\u6587\u4ef6\uff01"),!1;var f=new FileReader;f.readAsDataURL(e);f.onload=function(f){f=this.result;var e=new Image,l;e.onload=function(){if(a.imgs&&0<a.imgs.length)for(var f=0;f<a.imgs.length;f++){var h=a.imgs[f];h.disTop||(a.stage.removeChild(h),a.imgs.splice(f,
1))}a.addImage({img:e,exif:l,disMove:!0,disScale:!0,disRotate:!0});"function"===typeof c.fileComplete&&c.fileComplete.call(null);if(a.imgs&&0<a.imgs.length)for(f=0;f<a.imgs.length;f++)h=a.imgs[f],h.disTop&&a.stage.addChild(h);a.trigger("change")};var h=f.replace(/^.*?,/,""),h=atob(h),h=new BinaryFile(h);l=EXIF.readFromBinaryFile(h);e.src=f}});a.stage.addEventListener("touchstart",function(c){if(a.imgs)for(var d=0;d<a.imgs.length;d++)a.imgs[d].disable();c.eventTarget&&c.eventTarget.parent.enEditable&&
(c.eventTarget.parent.enEditable(),a.activeTarget=c.eventTarget.parent)});a.stage.addEventListener("touchmove",function(a){});a.stage.addEventListener("touchend",function(c){a.activeTarget&&a.activeTarget.mcScale&&delete a.activeTarget.mcScale.touchDis})};this.addImage=function(a){var c=this,e=c.config,f=a.img,k=a.exif,g,l,h=f.width,m=f.height,r=0,n=0,z=0,w=(c.config.width-h)/2,p=(c.config.height-m)/2,w=0>w?0:w,p=a.disY?0>p?c.config.height/2:p:0>p?0:p,u=1,k=k?k.Orientation:1,y=function(a){if(/png$/i.test(a.src))return 1;
var b=a.naturalHeight,c=document.createElement("canvas");c.width=1;c.height=b;c=c.getContext("2d");c.drawImage(a,0,0);a=c.getImageData(0,0,1,b).data;for(var c=0,d=b,f=b;f>c;)0===a[4*(f-1)+3]?d=f:c=f,f=d+c>>1;b=f/b;return 0===b?1:b}(f);if("string"==typeof f){var K=f,f=new Image;f.src=K}switch(k){case 3:r=180;n=h;z=m*y;break;case 6:r=90;h=f.height;m=f.width;z=h*y;break;case 8:if(r=270,h=f.height,m=f.width,n=m*y,/iphone|ipod|ipad/i.test(navigator.userAgent)){alert("\u82f9\u679c\u7cfb\u7edf\u4e0b\u6682\u4e0d\u652f\u6301\u4f60\u4ee5\u8fd9\u4e48\u840c\uff01\u840c\uff01\u8fbe\uff01\u59ff\u52bf\u62cd\u7167\uff01");
return}}h*=y;h>c.stage.width&&(u=c.stage.width/h);h*=u;m=m*y*u;g=new Quark.DisplayObjectContainer({width:h,height:m});g.x=w;g.y=p;f=new Quark.Bitmap({image:f,regX:n,regY:z});f.rotation=r;f.x=0;f.y=0;f.scaleX=u*y;f.scaleY=u;g.disTop=a.disTop?!0:!1;var A=new Q.Graphics({width:h+10,height:m+10,x:-5,y:-5});A.lineStyle(5,"#aaa").beginFill("#fff").drawRect(5,5,h,m).endFill().cache();A.alpha=0.5;A.visible=!1;g.addChild(A);if(e.iconClose){var F=new Image;F.onload=function(){var a=e.iconClose.rect;l=new Quark.MovieClip({image:F});
l.addFrame([{rect:a}]);l.x=0;l.y=0;l.alpha=0.5;l.visible=!1;l.addEventListener("touchstart",function(a){l.alpha=0.8});l.addEventListener("touchend",function(a){c.stage.removeChild(g);a=c.imgs.indexOf(g);-1!==a&&c.imgs.splice(a,1)});c.stage.addEventListener("touchend",function(a){l.alpha=0.5});g.addChild(l)};F.src=e.iconClose.url}a.disable||(f.fnStart=function(a){if(!a.rawEvent||!a.rawEvent.touches[1])f.curW=g.getCurrentWidth(),f.curH=g.getCurrentHeight(),f.moveabled=!0,f.touchStart=[{x:a.eventX,y:a.eventY}],
delete f.startScaleDistance;else{var b=a.rawEvent.touches[0];a=a.rawEvent.touches[1];f.startScaleDistance=Math.sqrt(Math.pow(a.pageX-b.pageX,2)+Math.pow(a.pageY-b.pageY,2));f.touchStart=[{x:b.pageX,y:b.pageY},{x:a.pageX,y:a.pageY}];f.touchStartScale=[{x:b.pageX,y:b.pageY},{x:a.pageX,y:a.pageY}];f.imgContainerStartRotation=g.rotation;for(var e=f.touchStart,h=a=b=0;h<e.length;h++)b+=e[h].x,a+=e[h].y;b/=e.length;a/=e.length;b-=c.canvas.offsetLeft;a-=c.canvas.offsetTop;var e=h=0,e=Math.sqrt(Math.pow(g.regX*
g.scaleX,2)+Math.pow(g.regY*g.scaleY,2)),k=Math.atan2(g.regY,g.regX),k=180/Math.PI*k,h=g.x-Math.cos(Math.PI*(g.rotation+k)/180)*e,e=g.y-Math.sin(Math.PI*(g.rotation+k)/180)*e,b=b-h;a-=e;e=Math.sqrt(Math.pow(b,2)+Math.pow(a,2));k=Math.atan2(a,b);k*=180/Math.PI;b=e*Math.cos(Math.PI*(k-g.rotation)/180)/g.scaleX;a=e*Math.sin(Math.PI*(k-g.rotation)/180)/g.scaleY;b-=g.regX;a-=g.regY;g.regX+=b;g.regY+=a;e=Math.sqrt(Math.pow(b,2)+Math.pow(a,2));k=Math.atan2(a,b);k*=180/Math.PI;g.x+=e*Math.cos(Math.PI*(g.rotation+
k)/180)*g.scaleX;g.y+=e*Math.sin(Math.PI*(g.rotation+k)/180)*g.scaleY}},f.fnMove=function(c){var d=[],e=1<(f.touchStart&&f.touchStart.length)?!0:!1,d=e?[{x:c.rawEvent.touches[0].pageX,y:c.rawEvent.touches[0].pageY},{x:c.rawEvent.touches[1].pageX,y:c.rawEvent.touches[1].pageY}]:[{x:c.eventX,y:c.eventY}];if(!a.disScale&&e){c=Math.sqrt(Math.pow(d[1].x-d[0].x,2)+Math.pow(d[1].y-d[0].y,2));if(f.startScaleDistance){var h=c*g.scaleX/f.startScaleDistance;g.scaleX=h;g.scaleY=h}f.startScaleDistance=c}if(!a.disMove&&
f.moveabled){for(var k=h=c=0;k<d.length;k++)c+=d[k].x-f.touchStart[k].x,h+=d[k].y-f.touchStart[k].y;c/=d.length;h/=d.length;g.x+=c;g.y+=h;f.touchStart=d}e&&!a.disRotate&&(c=f.touchStartScale[1].x-f.touchStartScale[0].x,h=f.touchStartScale[1].y-f.touchStartScale[0].y,e=Math.atan2(h,c),e*=180/Math.PI,c=d[1].x-d[0].x,h=d[1].y-d[0].y,d=Math.atan2(h,c),d*=180/Math.PI,g.rotation=f.imgContainerStartRotation+d-e)},f.fnEnd=function(a){f.moveabled=!1;if(!a.rawEvent||!a.rawEvent.touches[1])f.curW=g.getCurrentWidth(),
f.curH=g.getCurrentHeight(),f.moveabled=!0,f.touchStart=[{x:a.eventX,y:a.eventY}],delete f.startScaleDistance;else{var b=a.rawEvent.touches[0];a=a.rawEvent.touches[1];f.startScaleDistance=Math.sqrt(Math.pow(a.pageX-b.pageX,2)+Math.pow(a.pageY-b.pageY,2));f.touchStart=[{x:b.pageX,y:b.pageY},{x:a.pageX,y:a.pageY}]}},f.addEventListener("touchstart",function(a){f.fnStart(a)}),f.addEventListener("touchmove",function(a){f.fnMove(a)}),f.addEventListener("touchend",function(a){f.fnEnd(a)}));g.enEditable=
function(){a.disable||(A.visible=!0,l&&(l.visible=!0))};g.disable=function(){A.visible=!1;l&&(l.visible=!1)};f.update=function(){g&&g.scaleX&&(l&&l.scaleX)&&(l.scaleX=1/g.scaleX,l.scaleY=1/g.scaleY,l.x=0)};g.addChild(f);c.stage.update=function(){};g.update=function(){};c.stage.addChild(g);c.imgs?c.imgs.push(g):c.imgs=[g];return g};this.clear=function(){if(this.imgs){for(var a=0;a<this.imgs.length;a++)this.stage.removeChild(this.imgs[a]);this.imgs=[]}};this.unSelect=function(){var a=this.imgs;if(a)for(var c=
0;c<a.length;c++)a[c].disable()};this.toDataURL=function(a){var c=this;c.unSelect();window.setTimeout(function(){var e=(new JPEGEncoder).encode(c.canvas.getContext("2d").getImageData(0,0,c.stage.width,c.stage.height),100);a.call(c,e)},1E3/c.config.fps)}})})()})();var apiUrl="http://nj.pflm.cn/njTelecomPost",apiList={userInfo:apiUrl+"/initialData.do",uploadQrCode:apiUrl+"/uploadQR.do",uploadPoster:apiUrl+"/createPost.do"},weuiLoading=null,editor=null,swiper=null,userToken=null,qrData=null,isPopup=!1;$(document).ready(function(){console.log("ver:2.4");audioAutoPlay();initData();initEvent()});
function initData(){userToken=getUrlParam("userToken");swiper=new Swiper("#SwiperContainer",{direction:"vertical",preloadImages:!0,updateOnImagesReady:!0,initialSlide:0,effect:"fade",noSwipingClass:"stop-swiping"});editor=new mo.ImageEditor({trigger:$("#createFile"),container:$("#editBox"),width:441,height:784,stageX:$("#editBox")[0].offsetLeft,fileComplete:function(){isPopup||($(".popup-box").fadeIn(),isPopup=!0)}});$("#qrcodeFile").on("change",function(c){lrz(this.files[0],{width:800,height:800}).then(function(a){var b=
a.base64;a=new Image;a.src=b;a.onload=function(a){var c=weui.loading("\u63d0\u4ea4\u4e2d...");setTimeout(function(){c.hide(function(){qrData=b;$("#qrImg").attr("src",qrData);$(".home-cxt").css({display:"none"});$(".result-cxt").css({display:"flex"})})},800)}})})}
function getUserInfo(c){weuiLoading=weui.loading("\u52a0\u8f7d\u4e2d...");$.ajax({url:apiList.userInfo,type:"get",data:{userToken:c},dataType:"jsonp",contentType:"application/json",success:function(a){weuiLoading.hide();if(1==a.code){if(qrData=a.QR)$(".home-cxt .btn-start").show(),$(".home-cxt .btn-upload1").addClass("again"),$("#qrImg").attr("src",qrData)}else weui.toast(a.msg,{className:"weui-warn"})},error:function(){weuiLoading.hide()}})}
function initEvent(){$(".btn-create").on("touchend",function(){editor&&(editor.imgs&&0<editor.imgs.length?editor.toDataURL(onSaveImage):weui.toast("\u8bf7\u6dfb\u52a0\u56fe\u7247!",{className:"weui-warn"}))});$(".btn-close").on("touchend",function(){$(".popup-box").fadeOut()});$(".btn-upload2,.btn-start").on("touchend",initEditImage);$(".btn-sound").on("touchend",onHandleSound);$(".btn-again").on("touchend",function(){$(".section-edit").removeClass("edit-show");$(".result-cxt").css({display:"none"});
$(".home-cxt").css({display:"flex"});swiper.slideTo(0,500)})}function initEditImage(){editor&&qrData&&editor.addImage({img:document.querySelector("#qrImg"),disTop:!0,disRotate:!0,disY:!0});$(".section-edit").addClass("edit-show")}function onSaveImage(c){var a=weui.loading("\u751f\u6210\u4e2d...");setTimeout(function(){a.hide(function(){editor.clear();$(".section-edit").removeClass("edit-show");$("#posterBox").html('\x3cimg src\x3d"'+c+'" alt\x3d""\x3e');swiper.slideTo(1,500)})},800)}
function request(c,a,b,d,e){d&&(weuiLoading=weui.loading("\u63d0\u4ea4\u4e2d..."));$.ajax({url:c,data:b,type:a,dataType:"json",async:!0,success:function(a){weuiLoading&&weuiLoading.hide();1==a.code?e&&e.call(null,a):weui.toast(a.msg,{className:"weui-warn"})},error:function(){weuiLoading&&weuiLoading.hide();weui.toast("\u7f51\u7edc\u5f02\u5e38!",{className:"weui-warn"})}})}
function getUrlParam(c){var a=null;RegExp("[\\?\x26]"+c+"\x3d([^\x26]+)","i").test(document.location.search)&&(a=RegExp.$1);return a?decodeURIComponent(a):null}function audioAutoPlay(){var c=document.getElementById("audio");c&&c.play();document.addEventListener("WeixinJSBridgeReady",function(){c&&c.play()},!1)}function onHandleSound(){var c=document.getElementById("audio");c.paused?(c&&c.play(),$(".btn-sound").removeClass("sound-close")):(c&&c.pause(),$(".btn-sound").addClass("sound-close"))};